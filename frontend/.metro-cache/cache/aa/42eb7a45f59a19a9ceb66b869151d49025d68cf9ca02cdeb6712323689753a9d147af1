{"dependencies":[{"name":"../utils/auth-utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":56,"index":56}}],"key":"ZBmctxxjxi3m55Nlej4mfi6fkFI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.createAgentsModule = createAgentsModule;\n  var _utilsAuthUtilsJs = require(_dependencyMap[0], \"../utils/auth-utils.js\");\n  function createAgentsModule({\n    axios,\n    getSocket,\n    appId,\n    serverUrl,\n    token\n  }) {\n    const baseURL = `/apps/${appId}/agents`;\n    const getConversations = () => {\n      return axios.get(`${baseURL}/conversations`);\n    };\n    const getConversation = conversationId => {\n      return axios.get(`${baseURL}/conversations/${conversationId}`);\n    };\n    const listConversations = filterParams => {\n      return axios.get(`${baseURL}/conversations`, {\n        params: filterParams\n      });\n    };\n    const createConversation = conversation => {\n      return axios.post(`${baseURL}/conversations`, conversation);\n    };\n    const addMessage = async (conversation, message) => {\n      const room = `/agent-conversations/${conversation.id}`;\n      const socket = getSocket();\n      await socket.updateModel(room, {\n        ...conversation,\n        messages: [...(conversation.messages || []), message]\n      });\n      return axios.post(`${baseURL}/conversations/${conversation.id}/messages`, message);\n    };\n    const subscribeToConversation = (conversationId, onUpdate) => {\n      const room = `/agent-conversations/${conversationId}`;\n      const socket = getSocket();\n      return socket.subscribeToRoom(room, {\n        connect: () => {},\n        update_model: ({\n          data: jsonStr\n        }) => {\n          const conv = JSON.parse(jsonStr);\n          onUpdate === null || onUpdate === void 0 ? void 0 : onUpdate(conv);\n        }\n      });\n    };\n    const getWhatsAppConnectURL = agentName => {\n      const baseUrl = `${serverUrl}/api/apps/${appId}/agents/${encodeURIComponent(agentName)}/whatsapp`;\n      const accessToken = token !== null && token !== void 0 ? token : (0, _utilsAuthUtilsJs.getAccessToken)();\n      if (accessToken) {\n        return `${baseUrl}?token=${accessToken}`;\n      } else {\n        // No token - URL will redirect to login automatically\n        return baseUrl;\n      }\n    };\n    return {\n      getConversations,\n      getConversation,\n      listConversations,\n      createConversation,\n      addMessage,\n      subscribeToConversation,\n      getWhatsAppConnectURL\n    };\n  }\n});","lineCount":73,"map":[[7,2,2,0,"exports"],[7,9,2,0],[7,10,2,0,"createAgentsModule"],[7,28,2,0],[7,31,2,0,"createAgentsModule"],[7,49,2,0],[8,2,1,0],[8,6,1,0,"_utilsAuthUtilsJs"],[8,23,1,0],[8,26,1,0,"require"],[8,33,1,0],[8,34,1,0,"_dependencyMap"],[8,48,1,0],[9,2,2,7],[9,11,2,16,"createAgentsModule"],[9,29,2,34,"createAgentsModule"],[9,30,2,35],[10,4,2,37,"axios"],[10,9,2,42],[11,4,2,44,"getSocket"],[11,13,2,53],[12,4,2,55,"appId"],[12,9,2,60],[13,4,2,62,"serverUrl"],[13,13,2,71],[14,4,2,73,"token"],[15,2,2,80],[15,3,2,81],[15,5,2,83],[16,4,3,4],[16,10,3,10,"baseURL"],[16,17,3,17],[16,20,3,20],[16,29,3,29,"appId"],[16,34,3,34],[16,43,3,43],[17,4,4,4],[17,10,4,10,"getConversations"],[17,26,4,26],[17,29,4,29,"getConversations"],[17,30,4,29],[17,35,4,35],[18,6,5,8],[18,13,5,15,"axios"],[18,18,5,20],[18,19,5,21,"get"],[18,22,5,24],[18,23,5,25],[18,26,5,28,"baseURL"],[18,33,5,35],[18,49,5,51],[18,50,5,52],[19,4,6,4],[19,5,6,5],[20,4,7,4],[20,10,7,10,"getConversation"],[20,25,7,25],[20,28,7,29,"conversationId"],[20,42,7,43],[20,46,7,48],[21,6,8,8],[21,13,8,15,"axios"],[21,18,8,20],[21,19,8,21,"get"],[21,22,8,24],[21,23,8,25],[21,26,8,28,"baseURL"],[21,33,8,35],[21,51,8,53,"conversationId"],[21,65,8,67],[21,67,8,69],[21,68,8,70],[22,4,9,4],[22,5,9,5],[23,4,10,4],[23,10,10,10,"listConversations"],[23,27,10,27],[23,30,10,31,"filterParams"],[23,42,10,43],[23,46,10,48],[24,6,11,8],[24,13,11,15,"axios"],[24,18,11,20],[24,19,11,21,"get"],[24,22,11,24],[24,23,11,25],[24,26,11,28,"baseURL"],[24,33,11,35],[24,49,11,51],[24,51,11,53],[25,8,12,12,"params"],[25,14,12,18],[25,16,12,20,"filterParams"],[26,6,13,8],[26,7,13,9],[26,8,13,10],[27,4,14,4],[27,5,14,5],[28,4,15,4],[28,10,15,10,"createConversation"],[28,28,15,28],[28,31,15,32,"conversation"],[28,43,15,44],[28,47,15,49],[29,6,16,8],[29,13,16,15,"axios"],[29,18,16,20],[29,19,16,21,"post"],[29,23,16,25],[29,24,16,26],[29,27,16,29,"baseURL"],[29,34,16,36],[29,50,16,52],[29,52,16,54,"conversation"],[29,64,16,66],[29,65,16,67],[30,4,17,4],[30,5,17,5],[31,4,18,4],[31,10,18,10,"addMessage"],[31,20,18,20],[31,23,18,23],[31,29,18,23,"addMessage"],[31,30,18,30,"conversation"],[31,42,18,42],[31,44,18,44,"message"],[31,51,18,51],[31,56,18,56],[32,6,19,8],[32,12,19,14,"room"],[32,16,19,18],[32,19,19,21],[32,43,19,45,"conversation"],[32,55,19,57],[32,56,19,58,"id"],[32,58,19,60],[32,60,19,62],[33,6,20,8],[33,12,20,14,"socket"],[33,18,20,20],[33,21,20,23,"getSocket"],[33,30,20,32],[33,31,20,33],[33,32,20,34],[34,6,21,8],[34,12,21,14,"socket"],[34,18,21,20],[34,19,21,21,"updateModel"],[34,30,21,32],[34,31,21,33,"room"],[34,35,21,37],[34,37,21,39],[35,8,22,12],[35,11,22,15,"conversation"],[35,23,22,27],[36,8,23,12,"messages"],[36,16,23,20],[36,18,23,22],[36,19,23,23],[36,23,23,27,"conversation"],[36,35,23,39],[36,36,23,40,"messages"],[36,44,23,48],[36,48,23,52],[36,50,23,54],[36,51,23,55],[36,53,23,57,"message"],[36,60,23,64],[37,6,24,8],[37,7,24,9],[37,8,24,10],[38,6,25,8],[38,13,25,15,"axios"],[38,18,25,20],[38,19,25,21,"post"],[38,23,25,25],[38,24,25,26],[38,27,25,29,"baseURL"],[38,34,25,36],[38,52,25,54,"conversation"],[38,64,25,66],[38,65,25,67,"id"],[38,67,25,69],[38,78,25,80],[38,80,25,82,"message"],[38,87,25,89],[38,88,25,90],[39,4,26,4],[39,5,26,5],[40,4,27,4],[40,10,27,10,"subscribeToConversation"],[40,33,27,33],[40,36,27,36,"subscribeToConversation"],[40,37,27,37,"conversationId"],[40,51,27,51],[40,53,27,53,"onUpdate"],[40,61,27,61],[40,66,27,66],[41,6,28,8],[41,12,28,14,"room"],[41,16,28,18],[41,19,28,21],[41,43,28,45,"conversationId"],[41,57,28,59],[41,59,28,61],[42,6,29,8],[42,12,29,14,"socket"],[42,18,29,20],[42,21,29,23,"getSocket"],[42,30,29,32],[42,31,29,33],[42,32,29,34],[43,6,30,8],[43,13,30,15,"socket"],[43,19,30,21],[43,20,30,22,"subscribeToRoom"],[43,35,30,37],[43,36,30,38,"room"],[43,40,30,42],[43,42,30,44],[44,8,31,12,"connect"],[44,15,31,19],[44,17,31,21,"connect"],[44,18,31,21],[44,23,31,27],[44,24,31,29],[44,25,31,30],[45,8,32,12,"update_model"],[45,20,32,24],[45,22,32,26,"update_model"],[45,23,32,27],[46,10,32,29,"data"],[46,14,32,33],[46,16,32,35,"jsonStr"],[47,8,32,43],[47,9,32,44],[47,14,32,49],[48,10,33,16],[48,16,33,22,"conv"],[48,20,33,26],[48,23,33,29,"JSON"],[48,27,33,33],[48,28,33,34,"parse"],[48,33,33,39],[48,34,33,40,"jsonStr"],[48,41,33,47],[48,42,33,48],[49,10,34,16,"onUpdate"],[49,18,34,24],[49,23,34,29],[49,27,34,33],[49,31,34,37,"onUpdate"],[49,39,34,45],[49,44,34,50],[49,49,34,55],[49,50,34,56],[49,53,34,59],[49,58,34,64],[49,59,34,65],[49,62,34,68,"onUpdate"],[49,70,34,76],[49,71,34,77,"conv"],[49,75,34,81],[49,76,34,82],[50,8,35,12],[51,6,36,8],[51,7,36,9],[51,8,36,10],[52,4,37,4],[52,5,37,5],[53,4,38,4],[53,10,38,10,"getWhatsAppConnectURL"],[53,31,38,31],[53,34,38,35,"agentName"],[53,43,38,44],[53,47,38,49],[54,6,39,8],[54,12,39,14,"baseUrl"],[54,19,39,21],[54,22,39,24],[54,25,39,27,"serverUrl"],[54,34,39,36],[54,47,39,49,"appId"],[54,52,39,54],[54,63,39,65,"encodeURIComponent"],[54,81,39,83],[54,82,39,84,"agentName"],[54,91,39,93],[54,92,39,94],[54,103,39,105],[55,6,40,8],[55,12,40,14,"accessToken"],[55,23,40,25],[55,26,40,28,"token"],[55,31,40,33],[55,36,40,38],[55,40,40,42],[55,44,40,46,"token"],[55,49,40,51],[55,54,40,56],[55,59,40,61],[55,60,40,62],[55,63,40,65,"token"],[55,68,40,70],[55,71,40,73],[55,75,40,73,"getAccessToken"],[55,92,40,87],[55,93,40,87,"getAccessToken"],[55,107,40,87],[55,109,40,88],[55,110,40,89],[56,6,41,8],[56,10,41,12,"accessToken"],[56,21,41,23],[56,23,41,25],[57,8,42,12],[57,15,42,19],[57,18,42,22,"baseUrl"],[57,25,42,29],[57,35,42,39,"accessToken"],[57,46,42,50],[57,48,42,52],[58,6,43,8],[58,7,43,9],[58,13,44,13],[59,8,45,12],[60,8,46,12],[60,15,46,19,"baseUrl"],[60,22,46,26],[61,6,47,8],[62,4,48,4],[62,5,48,5],[63,4,49,4],[63,11,49,11],[64,6,50,8,"getConversations"],[64,22,50,24],[65,6,51,8,"getConversation"],[65,21,51,23],[66,6,52,8,"listConversations"],[66,23,52,25],[67,6,53,8,"createConversation"],[67,24,53,26],[68,6,54,8,"addMessage"],[68,16,54,18],[69,6,55,8,"subscribeToConversation"],[69,29,55,31],[70,6,56,8,"getWhatsAppConnectURL"],[71,4,57,4],[71,5,57,5],[72,2,58,0],[73,0,58,1],[73,3]],"functionMap":{"names":["<global>","createAgentsModule","getConversations","getConversation","listConversations","createConversation","addMessage","subscribeToConversation","socket.subscribeToRoom$argument_1.connect","socket.subscribeToRoom$argument_1.update_model","getWhatsAppConnectURL"],"mappings":"AAA;OCC;6BCE;KDE;4BEC;KFE;8BGC;KHI;+BIC;KJE;uBKC;KLQ;oCMC;qBCI,SD;0BEC;aFG;KNE;kCSC;KTU;CDU"},"hasCjsExports":false},"type":"js/module"}]}